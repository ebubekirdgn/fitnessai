"use strict";(self.webpackChunkfitness_ai=self.webpackChunkfitness_ai||[]).push([[677],{155:(e,t,r)=>{r.d(t,{E2:()=>o,Jx:()=>H,PY:()=>E,QM:()=>_,_w:()=>s,af:()=>R,dT:()=>T,f_:()=>n,jK:()=>S});const n={ANGLE_ELBOW:{NORMAL:[0,20],TRANS:[21,70],PASS:[71,140]},ELBOW_THRESH:[10,140],INACTIVE_THRESH:10,CNT_FRAME_THRESH:30},E={ANGLE_HIP_KNEE_VERT:{NORMAL:[0,32],TRANS:[35,65],PASS:[70,95]},HIP_THRESH:[10,50],ANKLE_THRESH:45,KNEE_THRESH:[50,70,95],OFFSET_THRESH:35,INACTIVE_THRESH:15,CNT_FRAME_THRESH:50},s={ANGLE_HIP_KNEE_VERT:{NORMAL:[0,32],TRANS:[35,65],PASS:[80,95]},HIP_THRESH:[15,50],ANKLE_THRESH:30,KNEE_THRESH:[50,80,95],OFFSET_THRESH:35,INACTIVE_THRESH:15,CNT_FRAME_THRESH:50},o={ANGLE_SHOULDER_HIP_VERT:{NORMAL:[30,60],TRANS:[61,75],PASS:[76,90]},HIP_THRESH:[0,10],NECK_THRESH:[10,30],INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},H={ANGLE_SHOULDER_HIP_VERT:{NORMAL:[35,55],TRANS:[56,70],PASS:[71,85]},HIP_THRESH:[0,5],NECK_THRESH:[5,20],INACTIVE_THRESH:8,CNT_FRAME_THRESH:50},R={ANGLE_ELBOW:{NORMAL:[0,5],TRANS:[6,15],PASS:[16,25]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},T={ANGLE_ELBOW:{NORMAL:[25,30],TRANS:[31,89],PASS:[90,120]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},_={ANGLE_SHOULDER:{NORMAL:[0,15],TRANS:[16,45],PASS:[46,90]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},S={ANGLE_SHOULDER:{NORMAL:[0,10],TRANS:[11,45],PASS:[46,90]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50}},677:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var n=r(43),E=r(29),s=r.n(E),o=r(879),H=r(943),R=r(155);const T=(e,t,r)=>({x:e.x*t,y:e.y*r}),_=e=>Math.sqrt(e.x*e.x+e.y*e.y),S=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};const n={x:e.x-r.x,y:e.y-r.y},E={x:t.x-r.x,y:t.y-r.y},s=((o=n).x*(H=E).x+o.y*H.y)/(_(n)*_(E));var o,H;const R=Math.acos(Math.max(Math.min(s,1),-1));return Math.round(R*(180/Math.PI))},a=function(e,t,r,n){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{boxWidth:s=8,textColor:o="rgb(0, 255, 0)",backgroundColor:H="rgb(0, 0, 0)",fontSize:R="16px",fontFamily:T="Arial",paddingX:_=20,paddingY:S=10}=E;e.font=`${R} ${T}`;const a=e.measureText(t).width,i=parseInt(R,10);((e,t,r,n,E,s,o)=>{e.fillStyle=o,e.beginPath(),e.moveTo(t+s,r),e.arcTo(t+n,r,t+n,r+E,s),e.arcTo(t+n,r+E,t,r+E,s),e.arcTo(t,r+E,t,r,s),e.arcTo(t,r,t+n,r,s),e.closePath(),e.fill()})(e,r-_,n-i-S,a+2*_,i+2*S,s,H),e.fillStyle=o,e.fillText(t,r,n+S/2)},i="rgb(255,50,50)",l="rgb(0,255,127)";var c=r(579);const N=function(){const e=(0,n.useRef)(null),t=(0,n.useRef)(null),[r,E]=(0,n.useState)(!0),[_,N]=(0,n.useState)(R.E2),A=(0,n.useRef)({state_seq:[],INACTIVE_TIME:0,DISPLAY_TEXT:Array(3).fill(!1),COUNT_FRAMES:Array(3).fill(0),CRUNCH_COUNT:0,IMPROPER_CRUNCH:0}),d=(0,n.useCallback)((r=>{if(e.current&&t.current){const n=t.current,E=n.getContext("2d");if(n.width=e.current.video.videoWidth,n.height=e.current.video.videoHeight,E.drawImage(e.current.video,0,0,n.width,n.height),r.poseLandmarks){const e=((e,t,r,n)=>{const E={head:1,left:{shoulder:11,hip:23,knee:25,ankle:27},right:{shoulder:12,hip:24,knee:26,ankle:28}};if("nose"===t)return T(e[E.nose],r,n);if("head"===t)return T(e[E.head],r,n);if("left"===t||"right"===t){const s=E[t];return{shoulder:T(e[s.shoulder],r,n),elbow:T(e[s.elbow],r,n),wrist:T(e[s.wrist],r,n),hip:T(e[s.hip],r,n),knee:T(e[s.knee],r,n),ankle:T(e[s.ankle],r,n),foot:T(e[s.foot],r,n)}}throw new Error("Feature must be 'nose', 'head', 'left', or 'right'.")})(r.poseLandmarks,"left",n.width,n.height),t=S(e.hip,e.shoulder,{x:e.shoulder.x,y:0});Math.abs(e.hip.y-e.shoulder.y)>_.HIP_THRESH[1]&&(A.current.DISPLAY_TEXT[0]=!0,A.current.IMPROPER_CRUNCH++);const s=S(e.shoulder,e.head,e.head);(s<_.NECK_THRESH[0]||s>_.NECK_THRESH[1])&&(A.current.DISPLAY_TEXT[1]=!0,A.current.IMPROPER_CRUNCH++);const o=(e=>{let t=null;return e>=_.ANGLE_SHOULDER_HIP_VERT.NORMAL[0]&&e<=_.ANGLE_SHOULDER_HIP_VERT.NORMAL[1]?t="s1":e>=_.ANGLE_SHOULDER_HIP_VERT.TRANS[0]&&e<=_.ANGLE_SHOULDER_HIP_VERT.TRANS[1]?t="s2":e>=_.ANGLE_SHOULDER_HIP_VERT.PASS[0]&&e<=_.ANGLE_SHOULDER_HIP_VERT.PASS[1]&&(t="s3"),t})(t);"s1"===o?(A.current.CRUNCH_COUNT++,A.current.state_seq=[]):A.current.state_seq.push(o),a(E,`Correct Crunches: ${A.current.CRUNCH_COUNT}`,10,20,{textColor:l}),a(E,`Incorrect Crunches: ${A.current.IMPROPER_CRUNCH}`,10,50,{textColor:i})}}}),[e,t,_]);return(0,n.useEffect)((()=>{const t=new o.Pose({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${e}`});let r;return t.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,smoothSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),e.current&&e.current.video&&(r=new H.Camera(e.current.video,{onFrame:async()=>{e.current&&e.current.video&&await t.send({image:e.current.video})},width:640,height:480}),r.start()),t.onResults(d),()=>{r&&r.stop()}}),[d]),(0,c.jsx)("div",{className:"card",children:(0,c.jsx)("div",{className:"card-body",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsx)(s(),{ref:e,style:{display:"none"}}),(0,c.jsx)("canvas",{ref:t,className:"w-100 h-100"})]}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("select",{onChange:e=>{const t="beginner"===e.target.value;E(t),N(t?R.E2:R.Jx)},value:r?"beginner":"pro",children:[(0,c.jsx)("option",{value:"beginner",children:"Beginner Mode"}),(0,c.jsx)("option",{value:"pro",children:"Pro Mode"})]})})]})})})}}}]);
//# sourceMappingURL=677.7a873e96.chunk.js.map
"use strict";(self.webpackChunkfitness_ai=self.webpackChunkfitness_ai||[]).push([[384],{82:(e,t,r)=>{r.d(t,{$H:()=>l,FS:()=>a,SK:()=>o,Tj:()=>T,gM:()=>E,hp:()=>c,m:()=>i});const n=(e,t,r)=>({x:e.x*t,y:e.y*r}),o=(e,t,r,o)=>{const s={nose:0,left:{shoulder:11,elbow:13,wrist:15,hip:23,knee:25,ankle:27,foot:31},right:{shoulder:12,elbow:14,wrist:16,hip:24,knee:26,ankle:28,foot:32}};if("nose"===t)return n(e[s.nose],r,o);if("left"===t||"right"===t){const l=s[t];return{shoulder:n(e[l.shoulder],r,o),elbow:n(e[l.elbow],r,o),wrist:n(e[l.wrist],r,o),hip:n(e[l.hip],r,o),knee:n(e[l.knee],r,o),ankle:n(e[l.ankle],r,o),foot:n(e[l.foot],r,o)}}throw new Error("Feature must be 'nose', 'left', or 'right'.")},s=e=>Math.sqrt(e.x*e.x+e.y*e.y),l=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};const n={x:e.x-r.x,y:e.y-r.y},o={x:t.x-r.x,y:t.y-r.y},l=((i=n).x*(c=o).x+i.y*c.y)/(s(n)*s(o));var i,c;const E=Math.acos(Math.max(Math.min(l,1),-1));return Math.round(E*(180/Math.PI))},i=function(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{boxWidth:s=8,textColor:l="rgb(0, 255, 0)",backgroundColor:i="rgb(0, 0, 0)",fontSize:c="16px",fontFamily:E="Arial",paddingX:a=20,paddingY:T=10}=o;e.font=`${c} ${E}`;const _=e.measureText(t).width,R=parseInt(c,10);((e,t,r,n,o,s,l)=>{e.fillStyle=l,e.beginPath(),e.moveTo(t+s,r),e.arcTo(t+n,r,t+n,r+o,s),e.arcTo(t+n,r+o,t,r+o,s),e.arcTo(t,r+o,t,r,s),e.arcTo(t,r,t+n,r,s),e.closePath(),e.fill()})(e,r-a,n-R-T,_+2*a,R+2*T,s,i),e.fillStyle=l,e.fillText(t,r,n+T/2)},c=(e,t,r,n)=>{e.beginPath(),e.arc(t.x,t.y,r,0,2*Math.PI),e.fillStyle=n,e.fill()},E=(e,t,r,n,o)=>{e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(r.x,r.y),e.strokeStyle=n,e.lineWidth=o,e.stroke()},a=(e,t,r,n)=>{const o=Math.sqrt((r.x-t.x)**2+(r.y-t.y)**2),s=Math.floor(o/5);for(let l=0;l<s;l++){const o=t.x+(r.x-t.x)/s*l,i=t.y+(r.y-t.y)/s*l;e.beginPath(),e.arc(o,i,1,0,2*Math.PI),e.fillStyle=n,e.fill()}},T={blue:"rgb(0,127,255)",red:"rgb(255,50,50)",green:"rgb(0,255,127)",light_green:"rgb(100,233,127)",yellow:"rgb(255,255,0)",magenta:"rgb(255,0,255)",white:"rgb(255,255,255)",cyan:"rgb(0,255,255)",light_blue:"rgb(102,204,255)"}},155:(e,t,r)=>{r.d(t,{E2:()=>l,Jx:()=>i,PY:()=>o,QM:()=>a,_w:()=>s,af:()=>c,dT:()=>E,f_:()=>n,jK:()=>T});const n={ANGLE_ELBOW:{NORMAL:[0,20],TRANS:[21,70],PASS:[71,140]},ELBOW_THRESH:[10,140],INACTIVE_THRESH:10,CNT_FRAME_THRESH:30},o={ANGLE_HIP_KNEE_VERT:{NORMAL:[0,32],TRANS:[35,65],PASS:[70,95]},HIP_THRESH:[10,50],ANKLE_THRESH:45,KNEE_THRESH:[50,70,95],OFFSET_THRESH:35,INACTIVE_THRESH:15,CNT_FRAME_THRESH:50},s={ANGLE_HIP_KNEE_VERT:{NORMAL:[0,32],TRANS:[35,65],PASS:[80,95]},HIP_THRESH:[15,50],ANKLE_THRESH:30,KNEE_THRESH:[50,80,95],OFFSET_THRESH:35,INACTIVE_THRESH:15,CNT_FRAME_THRESH:50},l={ANGLE_SHOULDER_HIP_VERT:{NORMAL:[30,60],TRANS:[61,75],PASS:[76,90]},HIP_THRESH:[0,10],NECK_THRESH:[10,30],INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},i={ANGLE_SHOULDER_HIP_VERT:{NORMAL:[35,55],TRANS:[56,70],PASS:[71,85]},HIP_THRESH:[0,5],NECK_THRESH:[5,20],INACTIVE_THRESH:8,CNT_FRAME_THRESH:50},c={ANGLE_ELBOW:{NORMAL:[0,5],TRANS:[6,15],PASS:[16,25]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},E={ANGLE_ELBOW:{NORMAL:[25,30],TRANS:[31,89],PASS:[90,120]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},a={ANGLE_SHOULDER:{NORMAL:[0,15],TRANS:[16,45],PASS:[46,90]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},T={ANGLE_SHOULDER:{NORMAL:[0,10],TRANS:[11,45],PASS:[46,90]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50}},384:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var n=r(43),o=r(29),s=r.n(o),l=r(879),i=r(943),c=r(155),E=r(82),a=r(579);const T=function(){const e=(0,n.useRef)(null),t=(0,n.useRef)(null),[r,o]=(0,n.useState)(!0),T=(0,n.useRef)(!1),[_,R]=(0,n.useState)(c.QM),u=(0,n.useRef)({state_seq:[],start_inactive_time:Date.now(),start_inactive_time_front:Date.now(),INACTIVE_TIME:0,INACTIVE_TIME_FRONT:0,DISPLAY_TEXT:Array(5).fill(!1),COUNT_FRAMES:Array(5).fill(0),INCORRECT_POSTURE:!1,prev_state:null,curr_state:null,LATERAL_RAISE_COUNT:0,IMPROPER_RAISE:0}),S={0:{text:"STRAIGHTEN YOUR ELBOWS",position:100,color:"rgb(255,80,80)"},1:{text:"LOWER YOUR ARMS",position:130,color:"rgb(255,80,80)"},2:{text:"RAISE YOUR ARMS HIGHER",position:160,color:"rgb(255,80,80)"},3:{text:"KEEP YOUR ARMS PARALLEL",position:190,color:"rgb(255,80,80)"},4:{text:"CAMERA NOT ALIGNED PROPERLY!",position:50,color:"rgb(255,153,0)"}},d=(0,n.useCallback)((r=>{if(e.current&&t.current){const o=t.current,s=o.getContext("2d");o.width=e.current.video.videoWidth,o.height=e.current.video.videoHeight;const l=o.width,i=o.height;s.drawImage(e.current.video,0,0,o.width,o.height);let c=!1,a=Date.now();if(r.poseLandmarks){const e=(0,E.SK)(r.poseLandmarks,"nose",l,i),t=(0,E.SK)(r.poseLandmarks,"left",o.width,o.height),R=(0,E.SK)(r.poseLandmarks,"right",o.width,o.height),d=(0,E.$H)(t.shoulder,R.shoulder,e);if(d>_.OFFSET_THRESH)c=!1,a=Date.now(),u.current.INACTIVE_TIME_FRONT+=a-u.current.start_inactive_time_front,u.current.start_inactive_time_front=a,u.current.INACTIVE_TIME_FRONT>=_.INACTIVE_THRESH&&(c=!0),(0,E.hp)(s,e,7,E.Tj.white),(0,E.hp)(s,t.shoulder,7,E.Tj.yellow),(0,E.hp)(s,R.shoulder,7,E.Tj.magenta),T.current&&(s.translate(o.width,0),s.scale(-1,1),s.translate(-o.width,0)),c&&(u.current.INACTIVE_TIME_FRONT=0,u.current.start_inactive_time_front=Date.now()),(0,E.m)(s,`CORRECT: ${u.current.LATERAL_RAISE_COUNT}`,.68*l,30,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(18, 185, 0)",fontSize:"14px"}),(0,E.m)(s,`INCORRECT: ${u.current.IMPROPER_RAISE}`,.68*l,80,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(221, 0, 0)",fontSize:"14px"}),(0,E.m)(s,"CAMERA NOT ALIGNED PROPERLY!!!",30,i-60,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(255, 153, 0)",fontSize:"14px"}),(0,E.m)(s,`OFFSET ANGLE: ${d.toFixed(2)}`,30,i-30,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(255, 153, 0)",fontSize:"14px"}),u.current.start_inactive_time=Date.now(),u.current.INACTIVE_TIME=0,u.current.prev_state=null,u.current.curr_state=null;else{u.current.INACTIVE_TIME_FRONT=0,u.current.start_inactive_time_front=Date.now();let e=null,r=0;Math.abs(t.foot.y-t.shoulder.y)>Math.abs(R.foot.y-R.shoulder.y)?(e=t,r=-1):(e=R,r=1);const o=(0,E.$H)(e.hip,{x:e.shoulder.x,y:0},e.shoulder);(0,E.hp)(s,e.shoulder,15,E.Tj.white);let i={x:e.shoulder.x,y:e.shoulder.y-80},d={x:e.shoulder.x,y:e.shoulder.y+20};(0,E.FS)(s,i,d,E.Tj.blue);const h=(0,E.$H)(e.shoulder,{x:e.elbow.x,y:0},e.elbow);(0,E.hp)(s,e.elbow,10,E.Tj.white),i={x:e.elbow.x,y:e.elbow.y-50},d={x:e.elbow.x,y:e.elbow.y+20},(0,E.FS)(s,i,d,E.Tj.blue);const A=(0,E.$H)(e.elbow,{x:e.wrist.x,y:0},e.wrist);(0,E.hp)(s,e.wrist,15,E.Tj.white),i={x:e.wrist.x,y:e.wrist.y-50},d={x:e.wrist.x,y:e.wrist.y+20},(0,E.FS)(s,i,d,E.Tj.blue),(0,E.gM)(s,e.shoulder,e.elbow,E.Tj.light_blue,4),(0,E.gM)(s,e.elbow,e.wrist,E.Tj.light_blue,4),(0,E.hp)(s,e.shoulder,7,E.Tj.yellow),(0,E.hp)(s,e.elbow,7,E.Tj.yellow),(0,E.hp)(s,e.wrist,7,E.Tj.yellow);const N=(n=h)>=_.ANGLE_SHOULDER.NORMAL[0]&&n<=_.ANGLE_SHOULDER.NORMAL[1]?"s1":n>=_.ANGLE_SHOULDER.TRANS[0]&&n<=_.ANGLE_SHOULDER.TRANS[1]?"s2":n>=_.ANGLE_SHOULDER.PASS[0]&&n<=_.ANGLE_SHOULDER.PASS[1]?"s3":null;u.current.curr_state=N,(e=>{let t=[...u.current.state_seq];"s2"===e?(!t.includes("s3")&&0===t.filter((e=>"s2"===e)).length||t.includes("s3")&&1===t.filter((e=>"s2"===e)).length)&&t.push(e):"s3"===e&&!t.includes("s3")&&t.includes("s2")&&t.push(e),u.current.state_seq=t})(N);const{state_seq:I,INCORRECT_POSTURE:x}=u.current;if("s1"===N)3!==I.length||x?(I.includes("s2")&&1===I.length||x)&&(u.current.INCORRECT_TRICEPS+=1):u.current.TRICEPS_COUNT+=1,u.current.state_seq=[],u.current.INCORRECT_POSTURE=!1;else{const t=u.current;h>_.ANGLE_SHOULDER.PASS[1]?t.DISPLAY_TEXT[0]=!0:h<_.ANGLE_SHOULDER.NORMAL[0]&&1===t.state_seq.filter((e=>"s2"===e)).length&&(t.DISPLAY_TEXT[1]=!0),Math.abs(e.shoulder.x-e.elbow.x)>_.OFFSET_THRESH&&(t.DISPLAY_TEXT[2]=!0,t.INCORRECT_POSTURE=!0),Math.abs(e.wrist.y-e.elbow.y)<_.WRIST_THRESH&&(t.DISPLAY_TEXT[3]=!0,t.INCORRECT_POSTURE=!0)}c=!1,u.current.curr_state===u.current.prev_state?(a=Date.now(),u.current.INACTIVE_TIME+=a-u.current.start_inactive_time,u.current.start_inactive_time=a,u.INACTIVE_TIME>=_.INACTIVE_THRESH&&(c=!0)):(u.current.start_inactive_time=Date.now(),u.current.INACTIVE_TIME=0);const C=T.current?l-e.shoulder.x+10:e.shoulder.x+10,H=T.current?l-e.elbow.x+15:e.elbow.x+15,g=T.current?l-e.wrist.x+10:e.wrist.x+10;(u.current.state_seq.includes("s3")||"s1"===N)&&(u.current.INCORRECT_POSTURE=!1),u.current.DISPLAY_TEXT.forEach(((e,t)=>{e&&(u.current.COUNT_FRAMES[t]+=1)})),(e=>{const t=u.current;t.DISPLAY_TEXT.forEach(((t,r)=>{if(t){const t=S[r];t&&(0,E.m)(e,t.text,30,t.position,{textColor:t.textColor||"black",backgroundColor:t.backgroundColor||"yellow",fontSize:"16px"})}})),t.INCORRECT_POSTURE&&(0,E.m)(e,"CORRECT YOUR POSTURE",30,300,{textColor:"white",backgroundColor:"red",fontSize:"16px"})})(s),c&&(u.current.start_inactive_time=Date.now(),u.current.INACTIVE_TIME=0),(0,E.m)(s,` ${h.toFixed(2)}`,H,e.elbow.y+10,{textColor:E.Tj.light_green,fontSize:"16px"}),(0,E.m)(s,`${o.toFixed(2)}`,C,e.shoulder.y+10,{textColor:E.Tj.light_green,fontSize:"16px"}),(0,E.m)(s,`${A.toFixed(2)}`,g,e.wrist.y+10,{textColor:E.Tj.light_green,fontSize:"16px"}),(0,E.m)(s,`CORRECT: ${u.current.LATERAL_RAISE_COUNT}`,.68*l,30,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(18, 185, 0)",fontSize:"14px"}),(0,E.m)(s,`INCORRECT: ${u.current.IMPROPER_RAISE}`,.68*l,80,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(221, 0, 0)",fontSize:"14px"}),u.current.DISPLAY_TEXT.forEach(((e,t)=>{u.current.COUNT_FRAMES[t]>_.CNT_FRAME_THRESH&&(u.current.DISPLAY_TEXT[t]=!1,u.current.COUNT_FRAMES[t]=0)})),u.current.prev_state=N}}else{T.current&&(s.translate(o.width,0),s.scale(-1,1),s.drawImage(e.current.video,0,0,o.width,o.height),s.setTransform(1,0,0,1,0,0));const t=Date.now();u.current.INACTIVE_TIME+=t-u.current.start_inactive_time;let r=!1;u.current.INACTIVE_TIME>=_.INACTIVE_THRESH&&(r=!0),u.current.start_inactive_time=t,(0,E.m)(s,`CORRECT: ${u.current.LATERAL_RAISE_COUNT}`,.68*l,30,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(18, 185, 0)",fontSize:"14px"}),(0,E.m)(s,`INCORRECT: ${u.current.IMPROPER_RAISE}`,.68*l,80,{textColor:"rgb(255, 255, 230)",backgroundColor:"rgb(221, 0, 0)",fontSize:"14px"}),r&&(u.current.start_inactive_time=Date.now(),u.current.INACTIVE_TIME=0),u.current.prev_state=null,u.current.curr_state=null,u.current.INACTIVE_TIME_FRONT=0,u.current.INCORRECT_POSTURE=!1,u.current.DISPLAY_TEXT=Array(5).fill(!1),u.current.start_inactive_time_front=Date.now()}}var n}),[e,t]);return(0,n.useEffect)((()=>{const t=new l.Pose({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${e}`});let r;t.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,smoothSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5});return t.onResults(d),e.current&&e.current.video&&(r=new i.Camera(e.current.video,{onFrame:async()=>{e.current&&e.current.video&&await t.send({image:e.current.video})},width:640,height:480}),r.start()),()=>{if(r&&r.stop(),e.current&&e.current.video&&e.current.video.srcObject){e.current.video.srcObject.getTracks().forEach((e=>e.stop()))}t.close()}}),[d]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)("div",{className:"col-md-6 col-sm-12 text-center mb-3",children:(0,a.jsx)("p",{children:"Video Alan\u0131"})}),(0,a.jsx)("div",{className:"col-md-6 col-sm-12 text-center mb-3",children:(0,a.jsx)("p",{children:"Bilgilendirme Alan\u0131"})})]}),(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{className:"col-md-6 col-sm-12 mb-3",children:[(0,a.jsx)(s(),{ref:e,style:{display:"none"}}),(0,a.jsx)("canvas",{ref:t,className:"h-full w-full object-contain",style:{maxWidth:"100%",maxHeight:"100%",position:"relative",left:0,top:0}})]}),(0,a.jsxs)("div",{className:"col-md-6 col-sm-12",children:[(0,a.jsxs)("select",{className:"form-select","aria-label":"Default select example",onChange:e=>{const t="beginner"===e.target.value;o(t);const r=t?c.QM:c.jK;R(r),console.log("Current Thresholds:",r)},value:r?"beginner":"pro",children:[(0,a.jsx)("option",{className:"dropdown-item",value:"beginner",children:"Beginner Mode"}),(0,a.jsx)("option",{className:"dropdown-item",value:"pro",children:"Pro Mode"})]}),(0,a.jsxs)("table",{className:"table mt-3",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",children:"Metric"}),(0,a.jsx)("th",{scope:"col",children:"Value"})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"Correct"}),(0,a.jsx)("td",{children:u.current.LATERAL_RAISE_COUNT})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"Incorrect"}),(0,a.jsx)("td",{children:u.current.IMPROPER_RAISE})]})]})]})]})]})]})})})}}}]);
//# sourceMappingURL=384.5a93517a.chunk.js.map
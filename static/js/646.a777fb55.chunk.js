"use strict";(self.webpackChunkfitness_ai=self.webpackChunkfitness_ai||[]).push([[646],{82:(e,t,r)=>{r.d(t,{$H:()=>i,FS:()=>d,SK:()=>l,Tj:()=>h,gM:()=>a,hp:()=>o,m:()=>s});const n=(e,t,r)=>({x:e.x*t,y:e.y*r}),l=(e,t,r,l)=>{const c={nose:0,left:{shoulder:11,elbow:13,wrist:15,hip:23,knee:25,ankle:27,foot:31},right:{shoulder:12,elbow:14,wrist:16,hip:24,knee:26,ankle:28,foot:32}};if("nose"===t)return n(e[c.nose],r,l);if("left"===t||"right"===t){const i=c[t];return{shoulder:n(e[i.shoulder],r,l),elbow:n(e[i.elbow],r,l),wrist:n(e[i.wrist],r,l),hip:n(e[i.hip],r,l),knee:n(e[i.knee],r,l),ankle:n(e[i.ankle],r,l),foot:n(e[i.foot],r,l)}}throw new Error("Feature must be 'nose', 'left', or 'right'.")},c=e=>Math.sqrt(e.x*e.x+e.y*e.y),i=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};const n={x:e.x-r.x,y:e.y-r.y},l={x:t.x-r.x,y:t.y-r.y},i=((s=n).x*(o=l).x+s.y*o.y)/(c(n)*c(l));var s,o;const a=Math.acos(Math.max(Math.min(i,1),-1));return Math.round(a*(180/Math.PI))},s=function(e,t,r,n){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{boxWidth:c=8,textColor:i="rgb(0, 255, 0)",backgroundColor:s="rgb(0, 0, 0)",fontSize:o="16px",fontFamily:a="Arial",paddingX:d=20,paddingY:h=10}=l;e.font=`${o} ${a}`;const u=e.measureText(t).width,x=parseInt(o,10);((e,t,r,n,l,c,i)=>{e.fillStyle=i,e.beginPath(),e.moveTo(t+c,r),e.arcTo(t+n,r,t+n,r+l,c),e.arcTo(t+n,r+l,t,r+l,c),e.arcTo(t,r+l,t,r,c),e.arcTo(t,r,t+n,r,c),e.closePath(),e.fill()})(e,r-d,n-x-h,u+2*d,x+2*h,c,s),e.fillStyle=i,e.fillText(t,r,n+h/2)},o=(e,t,r,n)=>{e.beginPath(),e.arc(t.x,t.y,r,0,2*Math.PI),e.fillStyle=n,e.fill()},a=(e,t,r,n,l)=>{e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(r.x,r.y),e.strokeStyle=n,e.lineWidth=l,e.stroke()},d=(e,t,r,n)=>{const l=Math.sqrt((r.x-t.x)**2+(r.y-t.y)**2),c=Math.floor(l/5);for(let i=0;i<c;i++){const l=t.x+(r.x-t.x)/c*i,s=t.y+(r.y-t.y)/c*i;e.beginPath(),e.arc(l,s,1,0,2*Math.PI),e.fillStyle=n,e.fill()}},h={blue:"rgb(0,127,255)",red:"rgb(255,50,50)",green:"rgb(0,255,127)",light_green:"rgb(100,233,127)",yellow:"rgb(255,255,0)",magenta:"rgb(255,0,255)",white:"rgb(255,255,255)",cyan:"rgb(0,255,255)",light_blue:"rgb(102,204,255)"}},646:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});var n=r(43),l=r(29),c=r.n(l),i=r(879),s=r(943),o=r(16),a=r(768),d=r(115),h=(r(342),r(82)),u=r(662),x=r(579);const y=function(){const e=(0,n.useRef)(null),t=(0,n.useRef)(null),r=(0,n.useRef)(null),l=(0,n.useRef)(null),{user:y}=(0,o.A)(),m=(0,u.Zp)(),[f,g]=(0,n.useState)(0),[b,j]=(0,n.useState)(0),[p,v]=(0,n.useState)(""),[w,k]=(0,n.useState)(!1),S=(0,n.useRef)(!1),M=[85,95],C=70,T=100,N=()=>{e.current&&e.current.video&&(r.current=new s.Camera(e.current.video,{onFrame:async()=>{e.current&&e.current.video&&l.current&&await l.current.send({image:e.current.video})},width:640,height:480}),r.current.start())},P=(0,n.useCallback)((r=>{if(e.current&&t.current){const n=t.current,l=n.getContext("2d");if(n.width=e.current.video.videoWidth,n.height=e.current.video.videoHeight,l.drawImage(e.current.video,0,0,n.width,n.height),r.poseLandmarks){const e=r.poseLandmarks,t=(e,t,r)=>{l.beginPath(),l.arc(e,t,5,0,2*Math.PI),l.fillStyle=r,l.fill()},c=(e,t,r)=>{l.fillStyle="white",l.font="16px Arial",l.fillText(r,e,t)},i={x:e[11].x*n.width,y:e[11].y*n.height},s={x:e[13].x*n.width,y:e[13].y*n.height},o={x:e[12].x*n.width,y:e[12].y*n.height},a={x:e[14].x*n.width,y:e[14].y*n.height};t(i.x,i.y,"yellow"),t(s.x,s.y,"red"),t(o.x,o.y,"yellow"),t(a.x,a.y,"red");const d=(0,h.$H)({x:i.x,y:1},i,s),u=(0,h.$H)({x:o.x,y:1},o,a);c(s.x+10,s.y,`${Math.round(d)}\xb0`),c(a.x+10,a.y,`${Math.round(u)}\xb0`);let x=!1;d>=M[0]&&d<=M[1]&&u>=M[0]&&u<=M[1]?(x=!0,v("Harika! Kollar\u0131n\u0131 do\u011fru \u015fekilde kald\u0131rd\u0131n.")):v("Kollar\u0131n\u0131 do\u011fru pozisyonda tutmaya \xe7al\u0131\u015f."),x&&!S.current?S.current=!0:!x&&S.current&&(d<C||u<C||d>T||u>T?j((e=>e+1)):g((e=>e+1)),S.current=!1)}}}),[]);return(0,n.useEffect)((()=>{const t=new i.Pose({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${e}`});return t.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,smoothSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),l.current=t,t.onResults(P),()=>{if(l.current&&(l.current.close(),l.current=null),r.current&&(r.current.stop(),r.current=null),e.current&&e.current.video&&e.current.video.srcObject){e.current.video.srcObject.getTracks().forEach((e=>e.stop())),e.current.video.srcObject=null}}}),[P]),(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{className:"card",children:(0,x.jsxs)("div",{className:"card-body",children:[(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md-6 col-sm-12 text-center mb-3",children:(0,x.jsx)("p",{children:"Video Alan\u0131"})}),(0,x.jsx)("div",{className:"col-md-6 col-sm-12 text-center mb-3",children:(0,x.jsx)("p",{children:"Bilgilendirme Alan\u0131"})})]}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsxs)("div",{className:"col-md-6 col-sm-12 mb-3",children:[(0,x.jsx)(c(),{ref:e,style:{display:"none"}}),(0,x.jsx)("canvas",{ref:t,className:"h-full w-full object-contain",style:{maxWidth:"100%",maxHeight:"100%",position:"relative",left:0,top:0}})]}),(0,x.jsxs)("div",{className:"col-md-6 col-sm-12",children:[(0,x.jsxs)("table",{className:"table mt-3",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{scope:"col",children:"Metric"}),(0,x.jsx)("th",{scope:"col",children:"Value"})]})}),(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"Correct"}),(0,x.jsx)("td",{children:f})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"Incorrect"}),(0,x.jsx)("td",{children:b})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:"Feedback"}),(0,x.jsx)("td",{children:p})]})]})]}),(0,x.jsx)("button",{className:"btn btn-success mt-3",onClick:()=>{k(!0),N()},children:"Start Sport"}),(0,x.jsx)("button",{className:"btn btn-danger mt-3 ms-2",onClick:()=>{if(0===f&&0===b||(async()=>{const e=null===y||void 0===y?void 0:y.id,t=(new Date).toISOString();try{const r=await(0,a.R7)({userId:e,exerciseId:4,correct:f,incorrect:b,createdDate:t});d.oR.success(`Kay\u0131t i\u015flemi ba\u015far\u0131yla tamamland\u0131! ${r}`)}catch(r){d.oR.error(`Sonu\xe7lar g\xf6nderilirken bir hata olu\u015ftu: ${r.message}`)}})(),g(0),j(0),l.current&&(l.current.close(),l.current=null),r.current&&(r.current.stop(),r.current=null),e.current&&e.current.video&&e.current.video.srcObject){e.current.video.srcObject.getTracks().forEach((e=>e.stop())),e.current.video.srcObject=null}if(k(!1),t.current){const e=t.current,r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),r.fillStyle="black",r.fillRect(0,0,e.width,e.height)}m("/profile")},children:"Finish Sport"})]})]})]})})})}}}]);
//# sourceMappingURL=646.a777fb55.chunk.js.map
"use strict";(self.webpackChunkfitness_ai=self.webpackChunkfitness_ai||[]).push([[781],{82:(e,t,r)=>{r.d(t,{$H:()=>i,FS:()=>h,SK:()=>n,Tj:()=>d,gM:()=>a,hp:()=>o,m:()=>c});const l=(e,t,r)=>({x:e.x*t,y:e.y*r}),n=(e,t,r,n)=>{const s={nose:0,left:{shoulder:11,elbow:13,wrist:15,hip:23,knee:25,ankle:27,foot:31},right:{shoulder:12,elbow:14,wrist:16,hip:24,knee:26,ankle:28,foot:32}};if("nose"===t)return l(e[s.nose],r,n);if("left"===t||"right"===t){const i=s[t];return{shoulder:l(e[i.shoulder],r,n),elbow:l(e[i.elbow],r,n),wrist:l(e[i.wrist],r,n),hip:l(e[i.hip],r,n),knee:l(e[i.knee],r,n),ankle:l(e[i.ankle],r,n),foot:l(e[i.foot],r,n)}}throw new Error("Feature must be 'nose', 'left', or 'right'.")},s=e=>Math.sqrt(e.x*e.x+e.y*e.y),i=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};const l={x:e.x-r.x,y:e.y-r.y},n={x:t.x-r.x,y:t.y-r.y},i=((c=l).x*(o=n).x+c.y*o.y)/(s(l)*s(n));var c,o;const a=Math.acos(Math.max(Math.min(i,1),-1));return Math.round(a*(180/Math.PI))},c=function(e,t,r,l){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{boxWidth:s=8,textColor:i="rgb(0, 255, 0)",backgroundColor:c="rgb(0, 0, 0)",fontSize:o="16px",fontFamily:a="Arial",paddingX:h=20,paddingY:d=10}=n;e.font=`${o} ${a}`;const _=e.measureText(t).width,u=parseInt(o,10);((e,t,r,l,n,s,i)=>{e.fillStyle=i,e.beginPath(),e.moveTo(t+s,r),e.arcTo(t+l,r,t+l,r+n,s),e.arcTo(t+l,r+n,t,r+n,s),e.arcTo(t,r+n,t,r,s),e.arcTo(t,r,t+l,r,s),e.closePath(),e.fill()})(e,r-h,l-u-d,_+2*h,u+2*d,s,c),e.fillStyle=i,e.fillText(t,r,l+d/2)},o=(e,t,r,l)=>{e.beginPath(),e.arc(t.x,t.y,r,0,2*Math.PI),e.fillStyle=l,e.fill()},a=(e,t,r,l,n)=>{e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(r.x,r.y),e.strokeStyle=l,e.lineWidth=n,e.stroke()},h=(e,t,r,l)=>{const n=Math.sqrt((r.x-t.x)**2+(r.y-t.y)**2),s=Math.floor(n/5);for(let i=0;i<s;i++){const n=t.x+(r.x-t.x)/s*i,c=t.y+(r.y-t.y)/s*i;e.beginPath(),e.arc(n,c,1,0,2*Math.PI),e.fillStyle=l,e.fill()}},d={blue:"rgb(0,127,255)",red:"rgb(255,50,50)",green:"rgb(0,255,127)",light_green:"rgb(100,233,127)",yellow:"rgb(255,255,0)",magenta:"rgb(255,0,255)",white:"rgb(255,255,255)",cyan:"rgb(0,255,255)",light_blue:"rgb(102,204,255)"}},155:(e,t,r)=>{r.d(t,{E2:()=>i,Jx:()=>c,PY:()=>n,QM:()=>h,_w:()=>s,af:()=>o,dT:()=>a,f_:()=>l,jK:()=>d});const l={ANGLE_ELBOW:{NORMAL:[0,20],TRANS:[21,70],PASS:[71,140]},ELBOW_THRESH:[10,140],INACTIVE_THRESH:10,CNT_FRAME_THRESH:30},n={ANGLE_HIP_KNEE_VERT:{NORMAL:[0,32],TRANS:[35,65],PASS:[70,95]},HIP_THRESH:[10,50],ANKLE_THRESH:45,KNEE_THRESH:[50,70,95],OFFSET_THRESH:35,INACTIVE_THRESH:15,CNT_FRAME_THRESH:50},s={ANGLE_HIP_KNEE_VERT:{NORMAL:[0,32],TRANS:[35,65],PASS:[80,95]},HIP_THRESH:[15,50],ANKLE_THRESH:30,KNEE_THRESH:[50,80,95],OFFSET_THRESH:35,INACTIVE_THRESH:15,CNT_FRAME_THRESH:50},i={ANGLE_SHOULDER_HIP_VERT:{NORMAL:[30,60],TRANS:[61,75],PASS:[76,90]},HIP_THRESH:[0,10],NECK_THRESH:[10,30],INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},c={ANGLE_SHOULDER_HIP_VERT:{NORMAL:[35,55],TRANS:[56,70],PASS:[71,85]},HIP_THRESH:[0,5],NECK_THRESH:[5,20],INACTIVE_THRESH:8,CNT_FRAME_THRESH:50},o={ANGLE_ELBOW:{NORMAL:[0,5],TRANS:[6,15],PASS:[16,25]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},a={ANGLE_ELBOW:{NORMAL:[25,30],TRANS:[31,89],PASS:[90,120]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},h={ANGLE_SHOULDER:{NORMAL:[0,15],TRANS:[16,45],PASS:[46,90]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50},d={ANGLE_SHOULDER:{NORMAL:[0,10],TRANS:[11,45],PASS:[46,90]},OFFSET_THRESH:20,INACTIVE_THRESH:10,CNT_FRAME_THRESH:50}},781:(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var l=r(43),n=r(29),s=r.n(n),i=r(879),c=r(943),o=r(155),a=r(82),h=r(16),d=r(768),_=r(115),u=(r(342),r(662)),T=r(579);const E=function(){const e=(0,l.useRef)(null),t=(0,l.useRef)(null),r=(0,l.useRef)(null),n=(0,l.useRef)(null),{user:E}=(0,h.A)(),[R,S]=(0,l.useState)(!0),[g,x]=(0,l.useState)(0),[f,H]=(0,l.useState)(0),[A,N]=(0,l.useState)(!1),m=(0,u.Zp)(),[L,y]=(0,l.useState)(o.f_),b=(0,l.useRef)({state_seq_left:[],state_seq_right:[],CURL_COUNT:0,IMPROPER_CURL:0,DISPLAY_TEXT:{left:null,right:null},has_completed_tour_left:!1,has_completed_tour_right:!1,has_started_left:!1,has_started_right:!1,last_curl_left:null,last_curl_right:null}),C="STRAIGHTEN YOUR ARM",p="BEND YOUR ARM MORE",P="COMPLETE THE CURL",I=()=>{e.current&&e.current.video&&(r.current=new c.Camera(e.current.video,{onFrame:async()=>{e.current&&e.current.video&&n.current&&await n.current.send({image:e.current.video})},width:640,height:480}),r.current.start())},O=e=>e>=L.ANGLE_ELBOW.NORMAL[0]&&e<=L.ANGLE_ELBOW.NORMAL[1]?"s1":e>=L.ANGLE_ELBOW.TRANS[0]&&e<=L.ANGLE_ELBOW.TRANS[1]?"s2":e>=L.ANGLE_ELBOW.PASS[0]&&e<=L.ANGLE_ELBOW.PASS[1]?"s3":null,w=(e,t)=>{const r=b.current;let l=[..."left"===t?r.state_seq_left:r.state_seq_right];r.DISPLAY_TEXT[t]=null,"s1"===e?(l.includes("s3")?r.has_completed_tour_left&&r.has_completed_tour_right&&(r.CURL_COUNT+=1,x(b.current.CURL_COUNT),r.has_completed_tour_left=!1,r.has_completed_tour_right=!1,r.last_curl_left=Date.now(),r.last_curl_right=Date.now()):(r.has_started_left||r.has_started_right)&&("left"===t&&r.last_curl_left&&Date.now()-r.last_curl_left>2e3&&(r.IMPROPER_CURL+=1,H(b.current.IMPROPER_CURL)),"right"===t&&r.last_curl_right&&Date.now()-r.last_curl_right>2e3&&(r.IMPROPER_CURL+=1,H(b.current.IMPROPER_CURL))),l=[],r.has_started_left=!1,r.has_started_right=!1):"s2"===e&&0===l.length?(l.push(e),"left"===t&&(r.has_started_left=!0),"right"===t&&(r.has_started_right=!0)):"s3"===e&&l.includes("s2")&&(l.push(e),"left"===t&&(r.has_completed_tour_left=!0),"right"===t&&(r.has_completed_tour_right=!0)),"s1"===e?r.DISPLAY_TEXT[t]=C:"s2"===e?r.DISPLAY_TEXT[t]=p:"s3"===e&&(r.DISPLAY_TEXT[t]=P),"left"===t?r.state_seq_left=l:r.state_seq_right=l},j=(0,l.useCallback)((r=>{if(e.current&&t.current){const l=t.current,n=l.getContext("2d");if(l.width=e.current.video.videoWidth,l.height=e.current.video.videoHeight,n.clearRect(0,0,l.width,l.height),n.drawImage(e.current.video,0,0,l.width,l.height),r.poseLandmarks){const e=r.poseLandmarks[13],t=r.poseLandmarks[11],s=r.poseLandmarks[15],i=r.poseLandmarks[14],c=r.poseLandmarks[12],o=r.poseLandmarks[16],h=(0,a.$H)(t,e,s),d=(0,a.$H)(c,i,o),_=O(h),u=O(d);w(_,"left"),w(u,"right");const T=(e,t,r)=>{n.beginPath(),n.arc(e,t,5,0,2*Math.PI),n.fillStyle=r,n.fill()},E=(e,t,r)=>{n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.strokeStyle=r,n.lineWidth=4,n.stroke()};T(t.x*l.width,t.y*l.height,a.Tj.green),T(e.x*l.width,e.y*l.height,a.Tj.green),T(s.x*l.width,s.y*l.height,a.Tj.green),E({x:t.x*l.width,y:t.y*l.height},{x:e.x*l.width,y:e.y*l.height},a.Tj.blue),E({x:e.x*l.width,y:e.y*l.height},{x:s.x*l.width,y:s.y*l.height},a.Tj.blue),T(c.x*l.width,c.y*l.height,a.Tj.green),T(i.x*l.width,i.y*l.height,a.Tj.green),T(o.x*l.width,o.y*l.height,a.Tj.green),E({x:c.x*l.width,y:c.y*l.height},{x:i.x*l.width,y:i.y*l.height},a.Tj.blue),E({x:i.x*l.width,y:i.y*l.height},{x:o.x*l.width,y:o.y*l.height},a.Tj.blue),n.fillStyle=a.Tj.white,n.font="16px Arial",n.fillText(`Left Elbow Angle: ${h.toFixed(2)}`,30,30),n.fillText(`Right Elbow Angle: ${d.toFixed(2)}`,30,60),n.fillText(`Correct Curls: ${b.current.CURL_COUNT}`,30,l.height-60),n.fillText(`Incorrect Curls: ${b.current.IMPROPER_CURL}`,30,l.height-30),b.current.DISPLAY_TEXT.left&&n.fillText(b.current.DISPLAY_TEXT.left,30,l.height-90),b.current.DISPLAY_TEXT.right&&n.fillText(b.current.DISPLAY_TEXT.right,30,l.height-120)}}}),[]);return(0,l.useEffect)((()=>{const t=new i.Pose({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/pose/${e}`});return t.setOptions({modelComplexity:1,smoothLandmarks:!0,enableSegmentation:!1,smoothSegmentation:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),n.current=t,t.onResults(j),()=>{if(n.current&&(n.current.close(),n.current=null),r.current&&(r.current.stop(),r.current=null),e.current&&e.current.video&&e.current.video.srcObject){e.current.video.srcObject.getTracks().forEach((e=>e.stop())),e.current.video.srcObject=null}}}),[j]),(0,T.jsx)(T.Fragment,{children:(0,T.jsx)("div",{className:"card",children:(0,T.jsxs)("div",{className:"card-body",children:[(0,T.jsxs)("div",{className:"row",children:[(0,T.jsx)("div",{className:"col-md-6 col-sm-12 text-center mb-3",children:(0,T.jsx)("p",{children:"Video Alan\u0131"})}),(0,T.jsx)("div",{className:"col-md-6 col-sm-12 text-center mb-3",children:(0,T.jsx)("p",{children:"Bilgilendirme Alan\u0131"})})]}),(0,T.jsxs)("div",{className:"row",children:[(0,T.jsxs)("div",{className:"col-md-6 col-sm-12 mb-3",children:[(0,T.jsx)(s(),{ref:e,style:{display:"none"}}),(0,T.jsx)("canvas",{ref:t,className:"h-full w-full object-contain",style:{maxWidth:"100%",maxHeight:"100%",position:"relative",left:0,top:0}})]}),(0,T.jsxs)("div",{className:"col-md-6 col-sm-12",children:[(0,T.jsxs)("select",{className:"form-select","aria-label":"Default select example",onChange:e=>{const t="beginner"===e.target.value;S(t);const r=o.f_;y(r),console.log("Current Thresholds:",r)},value:R?"beginner":"pro",children:[(0,T.jsx)("option",{className:"dropdown-item",value:"beginner",children:"Beginner Mode"}),(0,T.jsx)("option",{className:"dropdown-item",value:"pro",children:"Pro Mode"})]}),(0,T.jsxs)("table",{className:"table mt-3",children:[(0,T.jsx)("thead",{children:(0,T.jsxs)("tr",{children:[(0,T.jsx)("th",{scope:"col",children:"Metric"}),(0,T.jsx)("th",{scope:"col",children:"Value"})]})}),(0,T.jsxs)("tbody",{children:[(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:"Correct"}),(0,T.jsx)("td",{children:g})]}),(0,T.jsxs)("tr",{children:[(0,T.jsx)("td",{children:"Incorrect"}),(0,T.jsx)("td",{children:f})]})]})]}),(0,T.jsx)("button",{className:"btn btn-success mt-3",onClick:()=>{N(!0),I()},children:"Start Sport"}),(0,T.jsx)("button",{className:"btn btn-danger mt-3 ms-2",onClick:()=>{if(0===g&&0===f||(async()=>{const e=null===E||void 0===E?void 0:E.id,t=(new Date).toISOString();try{const r=await(0,d.R7)({userId:e,exerciseId:1,correct:g,incorrect:f,createdDate:t});_.oR.success(`Kay\u0131t i\u015flemi ba\u015far\u0131yla tamamland\u0131! ${r}`)}catch(r){_.oR.error(`Sonu\xe7lar g\xf6nderilirken bir hata olu\u015ftu: ${r.message}`)}})(),x(0),H(0),b.current.BICEPS_CURL_COUNT=0,b.current.INCORRECT_CURL=0,n.current&&(n.current.close(),n.current=null),r.current&&(r.current.stop(),r.current=null),e.current&&e.current.video&&e.current.video.srcObject){e.current.video.srcObject.getTracks().forEach((e=>e.stop())),e.current.video.srcObject=null}if(N(!1),t.current){const e=t.current,r=e.getContext("2d");r.clearRect(0,0,e.width,e.height),r.fillStyle="black",r.fillRect(0,0,e.width,e.height)}m("/profile")},children:"Finish Sport"})]})]})]})})})}}}]);
//# sourceMappingURL=781.fb2e177f.chunk.js.map